{"Id":157,"Title":"Golang json 基本处理Example","Slug":"2014-12-24-1","Text":"``` go\npackage main\n\nimport (\n\t\"encoding/json\"\n\t\"fmt\"\n\t\"os\"\n)\n\ntype ConfigStruct struct {\n\tHost              string   `json:\"host\"`\n\tPort              int      `json:\"port\"`\n\tAnalyticsFile     string   `json:\"analytics_file\"`\n\tStaticFileVersion int      `json:\"static_file_version\"`\n\tStaticDir         string   `json:\"static_dir\"`\n\tTemplatesDir      string   `json:\"templates_dir\"`\n\tSerTcpSocketHost  string   `json:\"serTcpSocketHost\"`\n\tSerTcpSocketPort  int      `json:\"serTcpSocketPort\"`\n\tFruits            []string `json:\"fruits\"`\n}\n\ntype Other struct {\n\tSerTcpSocketHost string   `json:\"serTcpSocketHost\"`\n\tSerTcpSocketPort int      `json:\"serTcpSocketPort\"`\n\tFruits           []string `json:\"fruits\"`\n}\n\nfunc main() {\n\tjsonStr := `\n        {\n            \"host\": \"http://localhost:10086\",\n            \"port\": 10086,\n            \"analytics_file\": \"abc\",\n            \"static_file_version\": 1,\n            \"static_dir\": \"/Users/jack/workspace/gowork/src/goTest/\",\n            \"templates_dir\": \"/Users/jack/workspace/gowork//templates/\",\n            \"serTcpSocketHost\": \":12340\",\n            \"serTcpSocketPort\": 12340,\n            \"fruits\": [\"apple\", \"peach\"]\n        }`\n\n\t//json str 转map\n\tvar dat map[string]interface{}\n\tif err := json.Unmarshal([]byte(jsonStr), \u0026dat); err == nil {\n\t\tfmt.Println(\"==============json str 转map=======================\")\n\t\tfmt.Println(dat)\n\t\tfmt.Println(dat[\"host\"])\n\t}\n\n\t//json str 转struct\n\tvar config ConfigStruct\n\tif err := json.Unmarshal([]byte(jsonStr), \u0026config); err == nil {\n\t\tfmt.Println(\"================json str 转struct==================\")\n\t\tfmt.Println(config)\n\t\tfmt.Println(config.Host)\n\t}\n\n\t//json str 转struct(部份字段)\n\tvar part Other\n\tif err := json.Unmarshal([]byte(jsonStr), \u0026part); err == nil {\n\t\tfmt.Println(\"================json str 转struct===================\")\n\t\tfmt.Println(part)\n\t\tfmt.Println(part.SerTcpSocketPort)\n\t}\n\n\t//struct 到json str\n\tif b, err := json.Marshal(config); err == nil {\n\t\tfmt.Println(\"================struct 到json str===================\")\n\t\tfmt.Println(string(b))\n\t}\n\n\t//map 到json str\n\tfmt.Println(\"================map 到json str============================\")\n\tenc := json.NewEncoder(os.Stdout)\n\tenc.Encode(dat)\n\n\t//array 到 json str\n\tarr := []string{\"hello\", \"apple\", \"python\", \"golang\", \"base\", \"peach\", \"pear\"}\n\tlang, err := json.Marshal(arr)\n\tif err == nil {\n\t\tfmt.Println(\"================array 到 json str========================\")\n\t\tfmt.Println(string(lang))\n\t}\n\n\t//json 到 []string\n\tvar wo []string\n\tif err := json.Unmarshal(lang, \u0026wo); err == nil {\n\t\tfmt.Println(\"================json 到 []string===========================\")\n\t\tfmt.Println(wo)\n\t}\n}```\n","Tags":["golang"],"CreateTime":1419408004,"EditTime":1419408048,"UpdateTime":1419408004,"IsComment":true,"IsLinked":false,"AuthorId":10,"Template":"blog.html","Type":"article","Status":"publish","Format":"markdown","Comments":[],"Hits":160}